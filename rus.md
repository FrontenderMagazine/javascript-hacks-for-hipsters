# JavaScript-хаки для хипстеров

JavaScript — это в основном чистая радость, но иногда бывает и не так.

Все время, пока мы пишем код, мы думаем о том, как бы избежать ошибок во время
исполнения кода в браузере. Конечно, это заставляет нас расти как программисты — 
в общем-то, нет другого варианта, кроме как представлять себе, пока мы пишем
строчку кода, как она будет исполняться.

Вот почему настолько важно, чтобы код был аккуратным. Компактным. Красивым.
Таким, чтобы в него влюбиться хотелось. Иначе JavaScript приведет вас в ужас.

Я собрал несколько забавных фрагментов кода, которые мне нравится использоваться
\вместо скучного, многословного кода. Кое-какие из этих фрагментов делают ваш
код компактнее, чище и более читаемым. А другие просто отлично помогают в отладке.

Все это я нашел в опенсорс-коде (до выхода в свет `node.js` весь код на
JavaScript, в общем-то, был опенсорсом), но я напишу их тут, как будто я сам все
это придумал.

**Хипстер-хак #1 - вызов метода**

Я реально ненавижу блоки if/else, и вот полезный прием, как можно вызывать
нужную функцию в зависимости от булевой переменной.

    // Тоска
    if (success) {
      obj.start();
    } else {
      obj.stop();
    }

    // По-хипстерски
    var method = (success ? 'start' : 'stop');
    obj[method]();

**Хипстер-хак #2 - склеивание строк**

Хорошо известно, что строки притягиваются друг к другу. Рано или поздно вам
придется соединить их вместе. Я совершенно не люблю склеивать их через `+`, так
что на помощь приходит `join()`.

    ['имя', 'фамилия'].join(' '); // = 'имя фамилия';

    ['молоко', 'кофе', 'сахар'].join(', '); // = 'молоко, кофе, сахар'


**Хипстер-хак #3 - оператор по умолчанию ||**

JavaScript совершенно не имеет понятия, что находится внутри объекта. Можно
получить объект как аргумент функции, можно прочитать его из сети или
конфигурационного файла. В любом случае можно использовать оператор || и второй
аргумент, если первый аргумент ложен.

    // примет значение 'Без имени', если myName пуста (или null, или undefined)
    var name = myName || 'Без имени';


    // проверим, что у нас есть объект options
    var doStuff = function(options) {
      options = options || {};
      // ...
    };

**Хипстер-хак #4 - оператор проверки на существование &&**

Похожий на *оператор по умолчанию* и очень полезный прием. Можно выкинуть из
кода почти все операторы *if*, и от этого все станет гораздо чище.

    // Скучно
    if (isThisAwesome) {
      alert('yes'); // не исполнится
    }

    // Отлично!
    isThisAwesome && alert('yes');

    // Еще можно писать более безопасный код
    var aCoolFunction = undefined;
    aCoolFunction && aCoolFunction(); // не запустится и не обрушит ваш код


**Хипстер-хак #5 - оператор XXX**

Мой личный патентованный способ (и можно использовать на работе). Если я пишу
код, а нужно свериться с вебом или поправить другую часть кода, я добавляю в код
строчку *xxx*. Естественно, при запуске код сломается, и я могу быстро вернуться
к этому месту и все починить. Гораздо проще искать эту строчку (обычно никто не
пишет xxx в коде), и не нужно думать, что писать в развернутом комментарии с
пометкой TODO.

    var z = 15;
    doSomeMath(z, 10);
    xxx // Отличная заглушка. Только я использую xxx, и эту строчку очень просто
    найти в коде, гораздо проще, чем TODO
    doSomeMoreMath(z, 15);

**Хипстер-хак #6 - замерить время**

Вам никогда не было интересно, что быстрее — цикл через i++ или i--? Мне тоже не
было. Ну а если кому-то интересно, можно использовать внутренние методы консоли
для замера времени, чтобы находить медленные циклы или другой код, который
блокирует цикл выполнения событий.

    var a = [1,2,3,4,5,6,7,8,9,10];

    console.time('testing_forward');
    for (var i = 0; i < a.length; i++);
    console.timeEnd('testing_forward');
    // output: testing_forward: 0.041ms

    console.time('testing_backwards');
    for (var i = a.length - 1; i >= 0; i--);
    console.timeEnd('testing_backwards');
    // output: testing_backwards: 0.030ms

**Хипстер-хак #7 - отладка**

Этот прием я узнал от разработчика на Java. Понятия не имею, как вышло так, что
он его знал, а я нет, но с тех пор я использую этот прием. Просто напишите в
коде: *debugger*

    var x = 1;
    debugger; // Все, код перестает исполняться, удачной отладки
    x++;


    var x = Math.random(2);
    if (x > 0.5) {
      debugger; // Условная точка прерывания
    }
    x--;

**Хипстер-хак #8 - олдскульная **отладка****

Мне как разработчику всегда было комфортнее использовать `printf-отладку`, а не
отлаживать код строчку за строчкой. Если вы разделяете мои пристрастия, то вам
нужно будет «вытащить» внтуренние переменные в глобальное пространство имен,
чтобы можно было время от времени их просматривать. Не забудьте убрать эти
данные перед тем, как делать коммит в систему контроля версий или выкладывать
на продакшн.

    var deeplyNestedFunction = function() {
      var private_object = {
        year: '2013'
      };

      // Глобальный объект для отладки
      pub = private_object;
    };

    // Теперь из консоли можно вызывать:
    pub.year;

**Хипстер-хак #9 - суперлегкие шаблоны**

Как, вы еще занимаетесь конкатенацией строк через оператор +? Есть способ
гораздо лучше добавить ваши данные в предложение. Он называется шаблонизацией,
и вот мини-фреймворк для этого размеров в 2.5 строчки кода.

    var firstName = 'Таль';
    var screenName = 'ketacode'

    // Чудовищно
    'Привет, меня зовут ' + firstName + ', а мой твиттер — @' + screenName;

    // Отлично
    var template = 'Привет, меня зовут {first-name}, а мой твиттер - @{screen-name}';
    var txt = template.replace('{first-name}', firstName)
                      .replace('{screen-name}', screenName);

**Как, вы все это знали?**

Даже мой патентованный оператор XXX?! Ну что, вы настоящий хипстер от JavaScript,
давайте поговорим в [твиттере][11].

 [11]: http://www.twitter.com/ketacode